# Чтение данных

### Чтение данных с постоянными слушателями

Чтобы прочитать данные по пути и прослушать изменения, используйте метод `addValueEventListener()` , чтобы добавить `ValueEventListener` в `DatabaseReference` .


| Слушатель   | Обратный вызов события | Типичное использование                                                               |
| -------------------- | ------------------------------------------ | --------------------------------------------------------------------------------------------------------- |
| `ValueEventListener` | `onDataChange()`                           | Чтение и прослушивание изменений всего содержимого пути. |

Вы можете использовать метод `onDataChange()` для чтения статического снимка содержимого по заданному пути в том виде, в каком оно существовало во время события. Этот метод запускается один раз, когда прослушиватель подключен, и снова каждый раз, когда данные, включая дочерние, изменяются. Обратному вызову события передается моментальный снимок, содержащий все данные в этом месте, включая дочерние данные. Если данных нет, снимок будет возвращать `false` , когда вы вызываете `exists()` , и `null` , когда вы вызываете `getValue()` .

> **Важно:** метод `onDataChange()` вызывается каждый раз, когда данные изменяются в указанной ссылке на базу данных, включая изменения дочерних элементов. Чтобы ограничить размер снимков, присоединяйте их только на самом высоком уровне, необходимом для просмотра изменений. Например, не рекомендуется присоединять прослушиватель к корню вашей базы данных.

В следующем примере показано, как приложение для ведения социальных блогов извлекает сведения о публикации из базы данных:

```
val postListener = object : ValueEventListener {
    override fun onDataChange(dataSnapshot: DataSnapshot) {
        // Get Post object and use the values to update the UI
        val post = dataSnapshot.getValue<Post>()
        // ...
    }

    override fun onCancelled(databaseError: DatabaseError) {
        // Getting Post failed, log a message
        Log.w(TAG, "loadPost:onCancelled", databaseError.toException())
    }
}
postReference.addValueEventListener(postListener)
```

![](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)![](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw== "Click and drag to move")

Прослушиватель получает `DataSnapshot` , содержащий данные в указанном месте базы данных на момент события. Вызов `getValue()` моментального снимка возвращает объектное представление данных Java. Если в этом месте нет данных, вызов `getValue()` возвращает `null` .

В этом примере `ValueEventListener` также определяет метод `onCancelled()` , который вызывается при отмене чтения. Например, чтение может быть отменено, если у клиента нет разрешения на чтение из базы данных Firebase. Этому методу передается объект `DatabaseError` , указывающий, почему произошел сбой.
